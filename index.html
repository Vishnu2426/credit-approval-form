<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OTTO - Credit Approval</title>
  <link rel="icon" type="image/png" href="./otto logo.png">
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background-color: #f5f7fa;
      margin: 0;
      padding: 30px;
      color: #333;
    }

    h2 {
      text-align: center;
      color: #1a1a1a;
      margin-bottom: 25px;
    }

    form {
      background: #fff;
      padding: 25px 35px;
      border-radius: 10px;
      max-width: 850px;
      margin: auto;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px 25px;
    }

    label {
      font-weight: 600;
      display: block;
      margin-bottom: 5px;
      font-size: 14px;
    }

    input, select {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
      transition: all 0.2s;
      box-sizing: border-box;
    }

    input:focus, select:focus {
      border-color: #007bff;
      outline: none;
      box-shadow: 0 0 3px rgba(0, 123, 255, 0.25);
    }

    .section {
      margin-top: 25px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f7f9fc;
      padding: 10px 15px;
      border-radius: 6px;
      border-left: 4px solid #007bff;
    }

    .section-header h3 {
      margin: 0;
      color: #333;
      font-size: 16px;
    }

    .add-btn {
      background: #28a745;
      color: #fff;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .add-btn:hover {
      background: #218838;
    }

    .delete-btn {
      position: absolute;
      right: 10px;
      top: 10px;
      background-color: #dc3545;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 4px 8px;
      cursor: pointer;
      font-size: 12px;
    }

    .delete-btn:hover {
      background-color: #c82333;
    }

    .item-box {
      background: #fafafa;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
      position: relative;
    }

    #totalAmount {
      font-weight: 600;
      color: #007bff;
      margin-top: 10px;
      display: block;
      font-size: 15px;
    }

    button[type="submit"] {
      background: #007bff;
      color: #fff;
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      margin-top: 25px;
    }

    button[type="submit"]:hover {
      background: #0069d9;
    }

    hr {
      margin: 25px 0;
      border: none;
      height: 1px;
      background-color: #e2e6ea;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 768px) {
      .grid-2 {
        grid-template-columns: 1fr;
      }

      form {
        padding: 20px;
      }
    }
  </style>
</head>
<body>

  <h2>Raise Credit Approval Request</h2>

  <form action="https://wowflo.io/webhook/194c8d82-eb8d-4599-b6a2-c0343a55d566" method="POST" enctype="multipart/form-data">
    
    <div class="grid-2">
      <div>
        <label>Customer Name:</label>
        <input type="text" name="customer_name" required>
      </div>
      <div>
        <label>Order Date:</label>
        <input type="date" name="order_date" required>
      </div>
    </div>

    <!-- Order Section -->
    <div class="section">
      <div class="section-header">
        <h3>Order Details</h3>
        <button type="button" class="add-btn" onclick="addOrderItem()">+ Add Order</button>
      </div>
      <div id="order-items">
        <div class="item-box">
          <div class="grid-2">
            <div>
              <label>Order ID:</label>
              <input type="text" name="order_id[]" required>
            </div>
            <div>
              <label>Category:</label>
              <select name="category[]">
                <option value="Vest/Brief">Vest & Brief</option>
                <option value="Trunk">Trunk</option>
                <option value="Shorts">Shorts</option>
                <option value="Track">Track</option>
                <option value="T-Shirt">T-Shirt</option>
              </select>
            </div>
            <div>
              <label>Quantity:</label>
              <input type="number" name="quantity[]" min="1" required>
            </div>
            <div>
              <label>Amount:</label>
              <input type="number" name="amount[]" step="0.01" required>
            </div>
          </div>
          <button type="button" class="delete-btn" onclick="deleteItem(this)">X</button>
        </div>
      </div>
    </div>

    <div class="grid-2 section">
      <div>
        <label>Executive Name:</label>
        <input type="text" name="executive_name">
      </div>
      <div>
        <label>State:</label>
        <select name="state" id="stateSelect" required onchange="checkState()">
          <option value="">Select State</option>
          <option>Tamil Nadu</option>
          <option>Kerala</option>
          <option>Karnataka</option>
          <option>Andhra Pradesh</option>
          <option>Telangana</option>
          <option>Maharashtra</option>
          <option>Delhi</option>
          <option>Gujarat</option>
          <option>Punjab</option>
          <option>West Bengal</option>
          <option>Others</option>
        </select>
      </div>
    </div>

    <div id="agmMailDiv" class="hidden">
      <label>AGM Mail ID:</label>
      <input type="email" name="agm_mail" placeholder="Enter AGM mail ID">
    </div>

    <!-- Pending Payment Section -->
    <!-- Pending Payment Section -->
<div class="section">
  <div class="section-header">
    <h3>Pending Payment Summary</h3>
    <button type="button" class="add-btn" onclick="addPendingPayment()">+ Add More</button>
  </div>

  <div id="pendingpaymentsummary">
    <div class="item-box">
      <div class="grid-2">
        <div>
          <label>Vendor & Customer Name:</label>
          <input type="text" name="Vendor[]" required>
        </div>
        <div>
          <label>Document Type:</label>
          <input type="text" name="Documenttype[]" required>
        </div>
        <div>
          <label>Document No:</label>
          <input type="text" name="DocumentNumber[]" required>
        </div>
        <div>
          <label>Amount:</label>
          <input type="number" name="pending_amount[]" oninput="updatePendingTotal()" required>
        </div>
        <div>
          <label>Adjusted:</label>
          <input type="number" name="Adjusted[]" oninput="updatePendingTotal()" required>
        </div>
        <div>
          <label>Pending Days:</label>
          <select name="pending_days[]">
            <option>Above 90 Days</option>
            <option>Above 120 Days</option>
          </select>
        </div>
        <div>
          <label>State:</label>
          <input type="text" name="pending_state[]" required>
        </div>
        
      </div>
      <button type="button" class="delete-btn" onclick="deleteItem(this)">X</button>
    </div>
  </div>

  <div style="margin-top:10px; font-weight:600; color:#007bff;">
    <p  hidden id="pendingTotalAmount">Total Amount: ₹0.00</p>
    <p hidden id="pendingTotalAdjusted">Total Adjusted: ₹0.00</p>
    <p id="pendingGrandTotal" style="color:#28a745;">Grand Total Pending: ₹0.00</p>
  </div>
</div>


    <!-- Expected Payment Section -->
    <div class="section">
      <div class="section-header">
        <h3>Payment Summary</h3>
        <button type="button" class="add-btn" onclick="addPaymentItem()">+ Add More</button>
      </div>
      <div id="payment-items">
        <div class="item-box">
          <div class="grid-2">
            <div>
              <label>Follow-up Date:</label>
              <input type="datetime-local" name="payment_followup_date[]" required>
            </div>
            <div>
              <label>Pending Amount:</label>
              <input type="number" name="payment_amount[]" step="0.01" oninput="updateTotal()">
            </div>
            <div>
              <label>Payment Mode:</label>
              <select name="payment_mode[]">
                <option>Cheque</option>
              </select>
            </div>

            <div>

              <label>Cheque No:</label>
              <input type="text" name="cheque_no[]">
            </div>
            <div>
              <label>Attachment:</label>
              <input type="file" name="payment_attachment[]" multiple accept=".pdf, .jpg, .jpeg, .png">
            </div>
          </div>
          <button type="button" class="delete-btn" onclick="deleteItem(this)">X</button>
        </div>
      </div>
      <span id="totalAmount">Total Pending Amount: ₹0</span>
    </div>

    <hr>

    <div class="grid-2">
      <div>
        <label>From Mail ID:</label>
        <input type="email" name="from_mail" placeholder="Enter Your Mail ID">
      </div>
      <div>
        <label>To Mail ID:</label>
        <input type="email" name="to_mail" placeholder="Enter RSM Mail ID">
      </div>
    </div>

    <button type="submit">Submit Request</button>
  </form>

  <script>
    function deleteItem(btn) {
      btn.closest('.item-box').remove();
      updateTotal();
    }

    function addOrderItem() {
      const c = document.getElementById('order-items');
      const d = c.firstElementChild.cloneNode(true);
      d.querySelectorAll('input').forEach(i => i.value = '');
      c.appendChild(d);
    }

    function addPendingPayment() {
      const c = document.getElementById('pendingpaymentsummary');
      const d = c.firstElementChild.cloneNode(true);
      d.querySelectorAll('input').forEach(i => i.value = '');
      c.appendChild(d);
    }

    function addPaymentItem() {
      const c = document.getElementById('payment-items');
      const d = c.firstElementChild.cloneNode(true);
      d.querySelectorAll('input').forEach(i => i.value = '');
      c.appendChild(d);
    }


  function updatePendingTotal() {
    let totalAmount = 0;
    let totalAdjusted = 0;

    document.querySelectorAll('input[name="pending_amount[]"]').forEach(el => {
      const val = parseFloat(el.value) || 0;
      totalAmount += val;
    });

    document.querySelectorAll('input[name="Adjusted[]"]').forEach(el => {
      const val = parseFloat(el.value) || 0;
      totalAdjusted += val;
    });

    const grandTotal = totalAmount - totalAdjusted;

    document.getElementById('pendingTotalAmount').textContent = `Total Amount: ₹${totalAmount.toFixed(2)}`;
    document.getElementById('pendingTotalAdjusted').textContent = `Total Adjusted: ₹${totalAdjusted.toFixed(2)}`;
    document.getElementById('pendingGrandTotal').textContent = `Grand Total Pending: ₹${grandTotal.toFixed(2)}`;
  }

  function addPendingPayment() {
    const c = document.getElementById('pendingpaymentsummary');
    const d = c.firstElementChild.cloneNode(true);
    d.querySelectorAll('input').forEach(i => i.value = '');
    c.appendChild(d);
  }



    function updateTotal() {
      let total = 0;
      document.querySelectorAll('input[name="payment_amount[]"]').forEach(el => {
        const v = parseFloat(el.value);
        if (!isNaN(v)) total += v;
      });
      document.getElementById('totalAmount').textContent = `Total Pending Amount: ₹${total.toFixed(2)}`;
    }

    function checkState() {
      const s = document.getElementById('stateSelect').value;
      document.getElementById('agmMailDiv').classList.toggle('hidden', s === 'Tamil Nadu' || !s);
    }
  </script>
</body>
</html>
